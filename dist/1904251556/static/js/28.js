webpackJsonp([28],{"8r41":function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l={data:function(){return{param:{},dataForm:{name:"",author:"",codePackage:"",htmlPackage:"",jsPackage:"",xmlPackage:"",encoded:"",functions:"",entityName:"",id:"",dbName:"",tableName:""},dataBaseData:[],dataSheetData:[],templateData:[],templateGroupData:[],filterDataBaseText:"",filterDatasheetText:"",filterTemplateText:"",multipleSelection:[],paramsList:[]}},activated:function(){this.getDataBasesList(),this.getTemplateGroupList(),this.getParams()},methods:{getDataBasesList:function(){var e=this;this.$http({url:this.$http.adornUrl("/codedbinfo/all"),method:"get"}).then(function(t){var a=t.data;e.dataBaseData=a.dbinfo})},getDataSheetsList:function(e){var t=this;this.$http({url:this.$http.adornUrl("/code/getTables"),method:"get",params:{dbinfoId:e}}).then(function(e){var a=e.data;t.dataSheetData=a.table})},getTemplateGroupList:function(){var e=this;this.$http({url:this.$http.adornUrl("/codetemplategroup/all"),method:"get"}).then(function(t){var a=t.data;console.log(a),e.templateGroupData=a.list})},getTemplateList:function(e){var t=this;this.$http({url:this.$http.adornUrl("/codetemplate/all"),method:"get",params:{groupId:e}}).then(function(e){var a=e.data;t.templateData=a.codetemplate})},dataBaseChange:function(e){this.dataForm.id=e.id,this.getDataSheetsList(e.id)},dataSheetChange:function(e){this.dataForm.tableName=e.tableName,this.dataForm.entityName=this.getClassName(e.tableName),this.dataForm.name=e.chinaName},link:function(e,t){return e.tableName+" - "+e.chinaName},handleSelectionChange:function(e){this.multipleSelection=[];for(var t=0;t<e.length;t++)this.multipleSelection.push(e[t].id)},genCode:function(){var e=this;this.$refs.dataForm.validate(function(t){t&&e.$axios({url:e.$http.adornUrl("/code/genCode?token="+e.$cookie.get("token")),method:"post",responseType:"blob",data:{codeDbinfoEntity:{id:e.dataForm.id},generationEntity:{codePackage:e.dataForm.codePackage,htmlPackage:e.dataForm.htmlPackage,jsPackage:e.dataForm.jsPackage,xmlPackage:e.dataForm.xmlPackage,author:e.dataForm.author,entityName:e.dataForm.entityName,name:e.dataForm.name,tableName:e.dataForm.tableName},encoded:e.dataForm.encoded,dbName:e.dataForm.dbName,templates:e.multipleSelection}}).then(function(e){console.log(e);var t=new Blob([e.data],{type:e.data.type}),a=window.URL.createObjectURL(t),l=document.createElement("a");l.href=a;var o=decodeURI(e.headers.name),r="unknown";o&&(r=decodeURI(o)),l.setAttribute("download",r),document.body.appendChild(l),l.click(),l.remove(),window.URL.revokeObjectURL(a)})})},getParams:function(){var e=this;this.$http({url:this.$http.adornUrl("/codegenparams/all"),method:"get"}).then(function(t){var a=t.data;e.paramsList=a.list})},toggleSelection:function(e){e?this.$refs.templateTable.toggleRowSelection(e):this.$refs.templateTable.clearSelection()},selectParam:function(e){var t=this.paramsList.find(function(t){return t.id===e});this.dataForm.author=t.author,this.dataForm.codePackage=t.codePackage,this.dataForm.htmlPackage=t.htmlPackage,this.dataForm.jsPackage=t.jsPackage,this.dataForm.xmlPackage=t.xmlPackage,this.dataForm.encoded=t.encoded,this.filterTemplateText=t.groupId,this.getTemplateList(t.groupId),this.dataForm.id=t.databaseId,this.getDataSheetsList(t.databaseId)},tableRowClassName:function(e){e.row;var t=e.rowIndex;return 1===t?"warning-row":3===t?"success-row":""},getClassName:function(e){for(var t=e.toLocaleLowerCase(),a=0,l="";-1!==(a=t.indexOf("_"));)l+=t.substring(0,a),t=t.substring(a+1,a+2).toUpperCase()+t.substring(a+2);return l=(l+=t).substring(0,1).toUpperCase()+l.substring(1)}}},o={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"mod-config"},[a("el-form",{ref:"dataForm",attrs:{model:e.dataForm,"label-width":"80px"}},[a("el-row",[a("el-col",{attrs:{span:6}},[a("el-form-item",{attrs:{label:"参数"}},[a("el-select",{attrs:{placeholder:"请选择参数"},on:{change:e.selectParam},model:{value:e.param,callback:function(t){e.param=t},expression:"param"}},e._l(e.paramsList,function(e){return a("el-option",{key:e.alias,attrs:{label:e.alias,value:e.id}})}))],1)],1),e._v(" "),a("el-col",{attrs:{span:6}},[a("el-form-item",{attrs:{label:"作者",prop:"author"}},[a("el-input",{model:{value:e.dataForm.author,callback:function(t){e.$set(e.dataForm,"author",t)},expression:"dataForm.author"}})],1)],1),e._v(" "),a("el-col",{attrs:{span:6}},[a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:e.genCode}},[e._v("生成")])],1)],1)],1),e._v(" "),a("el-row",[a("el-col",{attrs:{span:6}},[a("el-form-item",{attrs:{label:"Code包名",prop:"codePackage"}},[a("el-input",{model:{value:e.dataForm.codePackage,callback:function(t){e.$set(e.dataForm,"codePackage",t)},expression:"dataForm.codePackage"}})],1)],1),e._v(" "),a("el-col",{attrs:{span:6}},[a("el-form-item",{attrs:{label:"Html包名",prop:"htmlPackage"}},[a("el-input",{model:{value:e.dataForm.htmlPackage,callback:function(t){e.$set(e.dataForm,"htmlPackage",t)},expression:"dataForm.htmlPackage"}})],1)],1),e._v(" "),a("el-col",{attrs:{span:6}},[a("el-form-item",{attrs:{label:"JS包名",prop:"jsPackage"}},[a("el-input",{model:{value:e.dataForm.jsPackage,callback:function(t){e.$set(e.dataForm,"jsPackage",t)},expression:"dataForm.jsPackage"}})],1)],1),e._v(" "),a("el-col",{attrs:{span:6}},[a("el-form-item",{attrs:{label:"XML包名",prop:"xmlPackage"}},[a("el-input",{model:{value:e.dataForm.xmlPackage,callback:function(t){e.$set(e.dataForm,"xmlPackage",t)},expression:"dataForm.xmlPackage"}})],1)],1)],1),e._v(" "),a("el-row",[a("el-col",{attrs:{span:6}},[a("el-form-item",{attrs:{label:"编码",prop:"encoded"}},[a("el-select",{attrs:{placeholder:"请选择参数"},model:{value:e.dataForm.encoded,callback:function(t){e.$set(e.dataForm,"encoded",t)},expression:"dataForm.encoded"}},[a("el-option",{attrs:{label:"UTF-8",value:"UTF-8"}}),e._v(" "),a("el-option",{attrs:{label:"GBK",value:"GBK"}})],1)],1)],1),e._v(" "),a("el-col",{attrs:{span:6}},[a("el-form-item",{attrs:{label:"类名",prop:"entityName"}},[a("el-input",{model:{value:e.dataForm.entityName,callback:function(t){e.$set(e.dataForm,"entityName",t)},expression:"dataForm.entityName"}})],1)],1),e._v(" "),a("el-col",{attrs:{span:6}},[a("el-form-item",{attrs:{label:"功能",prop:"name"}},[a("el-input",{model:{value:e.dataForm.name,callback:function(t){e.$set(e.dataForm,"name",t)},expression:"dataForm.name"}})],1)],1),e._v(" "),a("el-col",{attrs:{span:6}},[a("el-form-item",{attrs:{label:"菜单",prop:"alias"}},[a("el-input",{model:{value:e.dataForm.alias,callback:function(t){e.$set(e.dataForm,"alias",t)},expression:"dataForm.alias"}})],1)],1)],1)],1),e._v(" "),a("el-row",[a("el-col",{attrs:{span:7}},[a("el-input",{attrs:{placeholder:"输入关键字进行过滤"},model:{value:e.filterDataBaseText,callback:function(t){e.filterDataBaseText=t},expression:"filterDataBaseText"}}),e._v(" "),a("el-table",{ref:"dataBaseTable",staticStyle:{width:"100%"},attrs:{data:e.dataBaseData.filter(function(t){return!e.filterDataBaseText||t.alias.toLowerCase().includes(e.filterDataBaseText.toLowerCase())}),"element-loading-text":"拼命加载中","element-loading-spinner":"el-icon-loading","max-height":"500",border:"","highlight-current-row":"","row-class-name":e.tableRowClassName,stripe:""},on:{"current-change":e.dataBaseChange}},[a("el-table-column",{attrs:{fixed:"",prop:"alias",label:"数据库",align:"center"}})],1)],1),e._v(" "),a("el-col",{attrs:{span:7,offset:1}},[a("el-input",{attrs:{placeholder:"输入关键字进行过滤"},model:{value:e.filterDatasheetText,callback:function(t){e.filterDatasheetText=t},expression:"filterDatasheetText"}}),e._v(" "),a("el-table",{ref:"dataSheetTable",staticStyle:{width:"100%"},attrs:{data:e.dataSheetData.filter(function(t){return!e.filterDatasheetText||t.tableName.toLowerCase().includes(e.filterDatasheetText.toLowerCase())}),height:"500","highlight-current-row":"",stripe:""},on:{"current-change":e.dataSheetChange}},[a("el-table-column",{attrs:{fixed:"",prop:"tableName",formatter:e.link,label:"数据表",align:"center"}})],1)],1),e._v(" "),a("el-col",{attrs:{span:7,offset:1}},[a("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择"},on:{change:function(t){e.getTemplateList(e.filterTemplateText)}},model:{value:e.filterTemplateText,callback:function(t){e.filterTemplateText=t},expression:"filterTemplateText"}},e._l(e.templateGroupData,function(e){return a("el-option",{key:e.name,attrs:{label:e.name,value:e.id}})})),e._v(" "),a("el-table",{ref:"templateTable",staticStyle:{width:"100%"},attrs:{data:e.templateData,"tooltip-effect":"dark","max-height":"500",stripe:""},on:{"selection-change":e.handleSelectionChange,"row-click":e.toggleSelection}},[a("el-table-column",{attrs:{type:"selection",width:"55"}}),e._v(" "),a("el-table-column",{attrs:{fixed:"",prop:"templateName",label:"模板",align:"center"}})],1)],1)],1)],1)},staticRenderFns:[]};var r=a("46Yf")(l,o,!1,function(e){a("8wyE")},"data-v-28fe765f",null);t.default=r.exports},"8wyE":function(e,t,a){var l=a("SMCS");"string"==typeof l&&(l=[[e.i,l,""]]),l.locals&&(e.exports=l.locals);a("XkoO")("0e07b2b4",l,!0)},SMCS:function(e,t,a){(e.exports=a("acE3")(!0)).push([e.i,"\n.el-table--enable-row-hover .el-table__body tr:hover>td[data-v-28fe765f]{\n  background-color: #cd4f49;\n}\n.el-table__body tr.current-row>td[data-v-28fe765f] {\n  background: #f57878 !important;\n}\n","",{version:3,sources:["/Users/zhangheng/git/Apollo/Catsby-vue/src/views/modules/code/codegeneration.vue"],names:[],mappings:";AACA;EACE,0BAA0B;CAC3B;AACD;EACE,+BAA+B;CAChC",file:"codegeneration.vue",sourcesContent:["\n.el-table--enable-row-hover .el-table__body tr:hover>td[data-v-28fe765f]{\n  background-color: #cd4f49;\n}\n.el-table__body tr.current-row>td[data-v-28fe765f] {\n  background: #f57878 !important;\n}\n"],sourceRoot:""}])}});
//# sourceMappingURL=28.js.map