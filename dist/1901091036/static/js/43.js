webpackJsonp([43],{MuUd:function(a,e,t){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r={data:function(){return{visible:!1,visibleP:!0,dataForm:{dbDriver:"",dbUrl:"",dbUserName:"",dbPassword:"",userId:"",dbType:"",crtUserId:"",crtTime:"",mdfUserId:"",mdfTime:"",options:[{value:"oracle",label:"oracle"},{value:"mysql",label:"mysql"}]},loading:!1,dataRule:{alias:[{required:!0,message:"不能为空",trigger:"blur"}],dbDriver:[{required:!0,message:"不能为空",trigger:"blur"}],dbUrl:[{required:!0,message:"不能为空",trigger:"blur"}],dbUserName:[{required:!0,message:"不能为空",trigger:"blur"}],dbPassword:[{required:!0,message:"不能为空",trigger:"blur"}],dbType:[{required:!0,message:"不能为空",trigger:"blur"}]}}},methods:{init:function(a){var e=this;this.dataForm.id=a||0,this.visible=!0,this.$nextTick(function(){e.$refs.dataForm.resetFields(),e.dataForm.id&&e.$http({url:e.$http.adornUrl("/codedbinfo/info"),method:"get",params:e.$http.adornParams({id:e.dataForm.id})}).then(function(a){var t=a.data;t&&0===t.code&&(e.dataForm.alias=t.codedbinfo.alias,e.dataForm.dbDriver=t.codedbinfo.dbDriver,e.dataForm.dbUrl=t.codedbinfo.dbUrl,e.dataForm.dbUserName=t.codedbinfo.dbUserName,e.dataForm.dbPassword=t.codedbinfo.dbPassword,e.dataForm.dbType=t.codedbinfo.dbType)})})},dataFormSubmit:function(){var a=this;this.$refs.dataForm.validate(function(e){e&&a.$http({url:a.$http.adornUrl("/codedbinfo/"+(a.dataForm.id?"update":"add")),method:"post",data:a.$http.adornData({id:a.dataForm.id||void 0,alias:a.dataForm.alias,dbDriver:a.dataForm.dbDriver,dbUrl:a.dataForm.dbUrl,dbUserName:a.dataForm.dbUserName,dbPassword:a.dataForm.dbPassword,dbType:a.dataForm.dbType,crtUserId:a.dataForm.crtUserId})}).then(function(e){var t=e.data;t&&0===t.code?a.$message({message:"操作成功",type:"success",duration:1500,onClose:function(){a.visible=!1,a.$emit("refreshDataList")}}):a.$message.error(t.msg)})})},testDataBasesConnect:function(){var a=this;this.loading=!0,this.$refs.dataForm.validate(function(e){e&&a.$http({url:a.$http.adornUrl("/codedbinfo/test"),method:"post",data:a.$http.adornData({dbDriver:a.dataForm.dbDriver,dbUrl:a.dataForm.dbUrl,dbUserName:a.dataForm.dbUserName,dbPassword:a.dataForm.dbPassword,dbType:a.dataForm.dbType})}).then(function(e){var t=e.data;t&&0===t.code?t.flag?(a.loading=!1,a.$message({message:"测试连接成功",type:"success",duration:1500})):a.$message({message:"测试连接失败",type:"success",duration:1500,onClose:function(){a.visible=!1}}):a.$message.error(t.msg)})})},changePass:function(a){this.visibleP=!("show"===a)}}},d={render:function(){var a=this,e=a.$createElement,t=a._self._c||e;return t("el-dialog",{directives:[{name:"loading",rawName:"v-loading",value:a.loading,expression:"loading"}],attrs:{title:a.dataForm.id?"修改":"新增","close-on-click-modal":!1,visible:a.visible,"element-loading-text":"拼命连接数据库中","element-loading-spinner":"el-icon-loading","element-loading-background":"rgba(0, 0, 0, 0)",center:""},on:{"update:visible":function(e){a.visible=e}}},[t("el-form",{ref:"dataForm",attrs:{model:a.dataForm,rules:a.dataRule,"label-width":"100px"},nativeOn:{keyup:function(e){if(!("button"in e)&&a._k(e.keyCode,"enter",13,e.key))return null;a.dataFormSubmit()}}},[t("el-row",[t("el-col",{attrs:{span:14}},[t("el-form-item",{attrs:{label:"别名",prop:"alias"}},[t("el-input",{attrs:{placeholder:"别名"},model:{value:a.dataForm.alias,callback:function(e){a.$set(a.dataForm,"alias",e)},expression:"dataForm.alias"}})],1)],1),a._v(" "),t("el-col",{attrs:{span:10}},[t("el-form-item",{attrs:{label:"数据库类型",prop:"dbType"}},[t("el-select",{attrs:{placeholder:"数据库类型"},model:{value:a.dataForm.dbType,callback:function(e){a.$set(a.dataForm,"dbType",e)},expression:"dataForm.dbType"}},a._l(a.dataForm.options,function(a){return t("el-option",{key:a.value,attrs:{label:a.label,value:a.value}})}))],1)],1)],1),a._v(" "),t("el-form-item",{attrs:{label:"数据库地址",prop:"dbUrl"}},[t("el-input",{attrs:{placeholder:"数据库地址"},model:{value:a.dataForm.dbUrl,callback:function(e){a.$set(a.dataForm,"dbUrl",e)},expression:"dataForm.dbUrl"}})],1),a._v(" "),t("el-form-item",{attrs:{label:"数据库账户",prop:"dbUserName"}},[t("el-input",{attrs:{placeholder:"数据库账户"},model:{value:a.dataForm.dbUserName,callback:function(e){a.$set(a.dataForm,"dbUserName",e)},expression:"dataForm.dbUserName"}})],1),a._v(" "),t("el-form-item",{attrs:{label:"连接密码",prop:"dbPassword"}},[t("el-input",{attrs:{placeholder:"连接密码"},model:{value:a.dataForm.dbPassword,callback:function(e){a.$set(a.dataForm,"dbPassword",e)},expression:"dataForm.dbPassword"}})],1),a._v(" "),a.visibleP?t("el-form-item",{attrs:{label:"新密码"}},[t("el-input",{attrs:{type:"password",placeholder:"请输入新密码"},model:{value:a.dataForm.dbPassword,callback:function(e){a.$set(a.dataForm,"dbPassword",e)},expression:"dataForm.dbPassword"}},[t("el-button",{attrs:{slot:"append"},on:{click:function(e){a.changePass("show")}},slot:"append"},[t("icon-svg",{attrs:{name:"xianshimima",width:"20px",height:"20px"}})],1)],1)],1):t("el-form-item",{attrs:{label:"新密码"}},[t("el-input",{attrs:{type:"text",placeholder:"请输入新密码"},model:{value:a.dataForm.dbPassword,callback:function(e){a.$set(a.dataForm,"dbPassword",e)},expression:"dataForm.dbPassword"}},[t("el-button",{attrs:{slot:"append"},on:{click:function(e){a.changePass("hide")}},slot:"append"},[t("icon-svg",{attrs:{name:"buxianshimima"}})],1)],1)],1)],1),a._v(" "),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{attrs:{type:"success"},on:{click:function(e){a.testDataBasesConnect()}}},[a._v("测试")]),a._v(" "),t("el-button",{on:{click:function(e){a.visible=!1}}},[a._v("取消")]),a._v(" "),t("el-button",{attrs:{type:"primary"},on:{click:function(e){a.dataFormSubmit()}}},[a._v("确定")])],1)],1)},staticRenderFns:[]},o=t("46Yf")(r,d,!1,null,null,null);e.default=o.exports}});